services:
  # ---------- Flask backend ----------
  - type: web
    name: email-agent-backend
    rootDir: backend-flask
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn app:app
    envVars:
      - key: GROQ_API_KEY
        sync: false          # set value in Render dashboard
      - key: GROQ_MODEL
        value: llama-3.1-8b-instant
      - key: FLASK_PORT
        value: "5000"

  # ---------- Django frontend ----------
  - type: web
    name: email-agent-frontend
    rootDir: frontend-django
    runtime: python
    buildCommand: pip install -r requirements.txt && python manage.py collectstatic --noinput
    startCommand: gunicorn email_site.wsgi:application
    envVars:
      # Point Django to your backend API
      - key: FLASK_API_BASE
        value: https://email-agent-backend.onrender.com
